name: Github Release

on:
  push:
    tags:
      - "v*.*.*"

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: release
    permissions: write-all
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    - name: Create zip
      run: zip -r tulona-${{ github.ref_name }}.zip .
    - name: Github release
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: >-
        gh release create ${{ github.ref_name }}
        'tulona-${{ github.ref_name }}.zip#Source code'
        --generate-notes
        --title "tulona ${{ github.ref_name }}"